<!DOCTYPE html>
<html lang="en" x-data="{ sidebarOpen: false }">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Clause Builder â€“ ContraktAI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs" defer></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Outfit', sans-serif;
      background-color: #0f172a; /* Slate-900 */
    }

    .bg-dark { background-color: #0f172a; }
    .bg-panel { background-color: #1e293b; } /* Slate-800 */
    .text-light { color: #f1f5f9; } /* Slate-100 */
    .text-muted { color: #94a3b8; } /* Slate-400 */
    .border-dark { border-color: #334155; } /* Slate-700 */
    .icon { width: 18px; height: 18px; stroke-width: 1.8; }
    .text-brand { color: #facc15; } /* Amber-400 */
    .border-brand { border-color: #facc15; }

    input:focus, textarea:focus, select:focus, button:focus {
      outline: none;
      box-shadow: 0 0 0 2px #facc15; /* Gold focus ring */
      border-color: #facc15;
    }

    input:hover, textarea:hover, select:hover, button:hover {
      border-color: #facc15;
    }

    a:hover {
      color: #facc15; /* Gold hover color */
    }

    [x-cloak] { display: none !important; }
    
    .clause-card {
      transition: all 0.2s ease;
    }
    .clause-text {
      white-space: pre-wrap;
    }
  </style>
</head>
<body class="text-light bg-dark">

<div class="flex min-h-screen" x-data="clauseBuilder">
  <div x-show="sidebarOpen" x-transition:enter="transition-opacity ease-linear duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition-opacity ease-linear duration-300" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-black/50 z-30 sm:hidden" @click="sidebarOpen = false" x-cloak></div>

  <aside x-cloak class="fixed z-40 inset-y-0 left-0 w-64 bg-panel shadow-lg sm:relative sm:translate-x-0 transform transition-transform duration-300 ease-in-out" :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'">
    <div class="flex flex-col h-full">
      <div class="flex items-center justify-between h-20 px-6 shrink-0 border-b border-slate-700">
        <a href="dashboard.html" class="text-2xl font-bold text-brand">ContraktAI</a>
        <button class="sm:hidden" @click="sidebarOpen = false">
          <i data-lucide="x" class="w-6 h-6 text-light"></i>
        </button>
      </div>
      <nav class="flex-1 px-6 py-6 flex flex-col justify-between">
          <div class="flex flex-col gap-4 text-sm font-medium text-light">
            <a href="dashboard.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="layout-dashboard" class="icon"></i>Dashboard</a>
            <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="file" class="icon"></i>My Documents</a>
            <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="bar-chart-3" class="icon"></i>Analytics</a>
            <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="shield-alert" class="icon"></i>Compliance Alerts</a>
            <a href="custom-clause.html" class="flex items-center gap-3 p-2 rounded-lg bg-slate-700 text-brand font-semibold"><i data-lucide="wrench" class="icon"></i>Clause Builder</a>
            <a href="legal-mail-gen.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="mail" class="icon"></i>Legal Email Gen</a>
            <a href="clause-explainer.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700"><i data-lucide="file-text" class="icon"></i>Clause Explainer</a>
        </div>
        <div>
            <a href="#" class="flex items-center gap-3 p-2 rounded-lg text-red-400 hover:bg-red-900/50 hover:text-red-300"><i data-lucide="log-out" class="icon"></i>Logout</a>
        </div>
      </nav>
    </div>
  </aside>

  <main class="flex-1 p-4 sm:p-8 space-y-6 sm:space-y-8">
    <div class="flex items-center gap-4">
        <button class="sm:hidden text-light" @click.stop="sidebarOpen = true">
            <i data-lucide="menu" class="w-7 h-7"></i>
        </button>
        <div class="flex items-center gap-3">
            <i data-lucide="wrench" class="w-8 h-8 text-brand"></i>
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold">Custom Clause Builder</h2>
                <p class="text-sm sm:text-base text-muted">Select clauses below to generate ready-to-use legal text for your documents.</p>
            </div>
        </div>
    </div>
      
    <section class="bg-panel rounded-xl shadow p-6">
      <div class="space-y-6">
        <div>
          <label class="block font-medium text-sm text-muted mb-1">Your Company Name</label>
          <input type="text" x-model="companyName" placeholder="e.g. ContraktAI Pvt Ltd" class="w-full border border-dark rounded-lg p-3 bg-dark text-light" />
        </div>

        <div>
          <label class="block mb-2 font-medium text-sm text-muted">Agreement Type</label>
          <select x-model="agreementType" class="w-full border border-dark rounded-lg p-3 bg-dark text-light">
            <option value="">-- Select an Agreement Type --</option>
            <template x-for="type in agreementTypes" :key="type">
              <option x-text="type" :value="type"></option>
            </template>
          </select>
        </div>

        <div x-show="agreementType" x-transition>
          <h3 class="font-semibold text-light mb-2">Select Clauses</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <template x-for="(enabled, clause) in clauseOptions[agreementType]" :key="clause">
              <label class="clause-card flex items-center justify-between bg-dark p-4 rounded-lg border border-dark hover:border-brand transition cursor-pointer">
                <div class="flex items-center gap-3">
                  <input type="checkbox" x-model="clauseOptions[agreementType][clause]" class="rounded h-4 w-4 text-amber-400 bg-slate-700 border-slate-600 focus:ring-amber-400" />
                  <span class="text-sm text-light" x-text="clause"></span>
                </div>
                <i data-lucide="info" class="icon text-muted" :title="clauseExplanations[clause] || 'No explanation available.'"></i>
              </label>
            </template>
          </div>
        </div>

        <div>
          <label class="block mb-1 font-medium text-sm text-muted">Custom Clause (Optional)</label>
          <textarea x-model="customClause" class="w-full border border-dark rounded-lg p-3 h-32 resize-none bg-dark text-light" placeholder="e.g., 'The service will be integrated with third-party API XYZ, and the user agrees to their terms.'"></textarea>
        </div>

        <button @click="generateDocument" :disabled="loading" class="w-full bg-amber-400 text-slate-900 font-semibold py-3 rounded-lg hover:bg-amber-500 transition flex items-center justify-center gap-2 disabled:bg-amber-600 disabled:cursor-not-allowed">
          <template x-if="loading">
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
          </template>
          <i x-show="!loading" data-lucide="file-text" class="icon"></i> 
          <span x-text="loading ? 'Generating...' : 'Generate Document'"></span>
        </button>
      </div>
    </section>

    <section x-show="documentOutput" x-cloak class="bg-panel rounded-xl shadow p-6">
      <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4">
        <h3 class="text-lg sm:text-xl font-semibold text-brand flex items-center gap-2">
          <i data-lucide="file-check-2" class="w-6 h-6"></i> AI-Generated Document
        </h3>
        <div class="flex gap-4">
          <button @click="downloadDocument" class="text-sm text-muted hover:text-brand flex items-center gap-1.5">
            <i data-lucide="download" class="w-4 h-4"></i> Download
          </button>
          <button @click="copyDocument" class="text-sm text-muted hover:text-brand flex items-center gap-1.5">
            <i data-lucide="copy" class="w-4 h-4"></i> Copy
          </button>
        </div>
      </div>
      
      <div class="bg-dark rounded-lg p-6 border border-dark clause-text text-sm leading-relaxed" x-html="documentOutput"></div>
    </section>
  </main>
</div>

<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('clauseBuilder', () => ({
      agreementType: '',
      companyName: '',
      customClause: '',
      documentOutput: '',
      loading: false,

      agreementTypes: [ "NDA", "Service Agreement", "Privacy Policy", "Employment Agreement", "Terms of Service", "Freelance Contract", "Partnership Agreement", "Consulting Agreement", "Software License Agreement" ],
      clauseOptions: { "NDA": { "Confidentiality": true, "Exclusions": false, "Term": true, "Governing Law": true, "No License Granted": false, "Remedies": false, "Return of Materials": false, "Mutuality": false }, "Service Agreement": { "Scope of Services": true, "Payment Terms": true, "Termination": true, "IP Ownership": false, "Confidentiality": true, "SLA": false, "Liability": false }, "Privacy Policy": { "Data Collection": true, "Cookies": false, "User Rights": true, "Data Sharing": false, "Retention": false, "Security": false, "Consent": true }, "Employment Agreement": { "Job Role": true, "Compensation": true, "Probation Period": false, "Benefits": false, "Non-Compete": false, "Termination": true, "Confidentiality": true }, "Terms of Service": { "User Responsibilities": true, "License Grant": true, "Termination": true, "Limitation of Liability": true, "Indemnification": false, "Dispute Resolution": false }, "Freelance Contract": { "Project Scope": true, "Payment Schedule": true, "IP Ownership": false, "Cancellation Policy": false, "Timeline": true, "Independent Contractor": true }, "Partnership Agreement": { "Capital Contributions": true, "Profit Sharing": true, "Roles & Responsibilities": true, "Exit Strategy": false, "Non-Compete": false, "Dispute Resolution": true }, "Consulting Agreement": { "Consulting Scope": true, "Fees & Expenses": true, "Deliverables": true, "IP Ownership": false, "Confidentiality": true, "Non-Solicitation": false }, "Software License Agreement": { "License Grant": true, "Restrictions": true, "Updates & Maintenance": false, "Term & Termination": true, "Fees": true, "Warranty Disclaimer": false, "Liability Limitation": true } },
      clauseExplanations: { "Confidentiality": "Keeps sensitive information private.", "Exclusions": "Details what is not confidential.", "Term": "Sets the agreement duration.", "Governing Law": "Decides which laws apply.", "No License Granted": "States no IP license is given.", "Remedies": "Legal recourse for breaches.", "Return of Materials": "Requires return of materials on termination.", "Mutuality": "Ensures equal obligations.", "Scope of Services": "Defines the work to be delivered.", "Payment Terms": "How and when payments are made.", "Termination": "How the agreement can end.", "IP Ownership": "Clarifies who owns created IP.", "SLA": "Service Level Agreement guarantees.", "Liability": "Limits damages one can claim.", "Data Collection": "What data is collected and why.", "Cookies": "Covers tracking and cookie usage.", "User Rights": "Data access, deletion, and consent.", "Data Sharing": "How data is shared externally.", "Retention": "How long data is stored.", "Security": "Measures to secure information.", "Consent": "Obtaining lawful user agreement.", "Job Role": "Employee's responsibilities.", "Compensation": "Salary and wages.", "Probation Period": "Trial period for new hires.", "Benefits": "Health insurance, perks, etc.", "Non-Compete": "Restricts working with competitors.", "User Responsibilities": "Rules for using the platform.", "License Grant": "Limited use of service/product.", "Limitation of Liability": "Restricts legal claims.", "Indemnification": "Covering damages for the other party.", "Dispute Resolution": "How legal issues will be resolved.", "Project Scope": "Defines project boundaries.", "Payment Schedule": "Timeline for payments.", "Cancellation Policy": "Terms for ending the contract.", "Timeline": "Deadlines and milestones.", "Independent Contractor": "Clarifies non-employee status.", "Capital Contributions": "Partner investments.", "Profit Sharing": "How revenue is split.", "Roles & Responsibilities": "What each partner does.", "Exit Strategy": "Terms for leaving the partnership.", "Consulting Scope": "Type of consulting provided.", "Fees & Expenses": "Billing structure.", "Deliverables": "Expected final outputs.", "Non-Solicitation": "Restricts luring employees/clients.", "Restrictions": "What the licensee cannot do.", "Updates & Maintenance": "Software upgrade conditions.", "Term & Termination": "When the agreement ends.", "Fees": "All costs involved.", "Warranty Disclaimer": "Denies implied guarantees.", "Liability Limitation": "Caps legal responsibility." },

      async generateDocument() {
        if (!this.agreementType) {
            alert("Please select an agreement type");
            return;
        }

        this.loading = true;
        this.documentOutput = '<p class="text-muted">Generating your document with AI... This may take a moment.</p>';
        
        const selectedClauses = Object.entries(this.clauseOptions[this.agreementType])
            .filter(([_, enabled]) => enabled)
            .map(([clause]) => clause);

        const prompt = `You are an expert legal assistant AI specializing in contract drafting. Your task is to generate a complete legal document based on the user's requirements.

Please generate a complete '${this.agreementType}'.

Use the following details:
- **Company Name:** "${this.companyName || '[Your Company Name]'}"
- **Required Standard Clauses:** ${JSON.stringify(selectedClauses)}
${this.customClause.trim() ? `- **Custom Clause to Include:** "${this.customClause.trim()}"` : ''}

Instructions:
1. Draft the full text for each of the required standard clauses.
2. If a custom clause is provided, integrate it seamlessly into the document as its own numbered section.
3. Use professional legal language and formatting, including numbered sections for each clause (e.g., 1. CONFIDENTIALITY, 2. TERM, etc.).
4. The entire output should be a single, coherent document.
5. Replace placeholders like '[Your Company Name]' with the provided company name.
6. Do not include any introductory text, closing remarks, or markdown formatting like \`\`\` in your response. Only output the raw text of the legal document.`;

        try {
            const response = await fetch("https://api.together.xyz/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Authorization": "Bearer tgp_v1_wRf1bIQjSxwgngfjzB9sgBN1S8iuY8LyRP2R2_awM9I",
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    model: "meta-llama/Llama-3.3-70B-Instruct-Turbo-Free",
                    messages: [{
                        role: "user",
                        content: prompt
                    }],
                    temperature: 0.5
                })
            });

            if (!response.ok) throw new Error(`API error: ${response.statusText}`);

            const data = await response.json();
            this.documentOutput = data.choices[0].message.content;

        } catch(error) {
            console.error("Failed to generate document:", error);
            this.documentOutput = `<p class="text-red-400">Sorry, an error occurred while generating the document. Please try again.</p>`;
        } finally {
            this.loading = false;
        }
      },

      copyDocument() {
        const temp = document.createElement('div');
        temp.innerHTML = this.documentOutput;
        const text = temp.innerText || '';
        
        navigator.clipboard.writeText(text)
          .then(() => alert("Document copied to clipboard!"))
          .catch(() => alert("Failed to copy document"));
      },

      downloadDocument() {
        const temp = document.createElement('div');
        temp.innerHTML = this.documentOutput;
        const text = temp.innerText || '';
        
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${this.agreementType.replace(/ /g, '_') || 'document'}_${new Date().toISOString().slice(0,10)}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }
    }))
  });
  
  lucide.createIcons();
</script>

</body>
</html>
